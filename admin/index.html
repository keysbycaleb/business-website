<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow">
    <title>Admin Portal | Lanting Digital</title>

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="https://lantingdigital.com/images/favicon.ico">

    <!-- Google Fonts - Source Sans Pro (Dimension Theme) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300italic,600italic,300,600" rel="stylesheet">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

    <!-- Styles -->
    <link rel="stylesheet" href="css/admin.css?v=20260103a">
</head>
<body>
    <!-- Dimension Background -->
    <div class="dimension-bg" aria-hidden="true"></div>

    <!-- LOGIN SCREEN -->
    <div id="login-screen" class="screen login-screen active">
        <div class="login-container">
            <div class="login-header">
                <h1>Lanting Digital</h1>
                <p>Admin Portal</p>
            </div>

            <!-- Google Sign-In Button -->
            <button type="button" class="btn btn-google btn-full" id="google-signin-btn">
                <i class="fab fa-google"></i> Sign in with Google
            </button>

            <div class="login-divider">
                <span>or</span>
            </div>

            <form id="login-form">
                <div class="form-group">
                    <label for="login-email">Email</label>
                    <input type="email" id="login-email" required placeholder="Enter your email">
                </div>
                <div class="form-group">
                    <label for="login-password">Password</label>
                    <input type="password" id="login-password" required placeholder="Enter your password">
                </div>
                <button type="submit" class="btn btn-primary btn-full">
                    <i class="fas fa-sign-in-alt"></i> Sign In
                </button>
                <p id="login-error" class="error-message"></p>
            </form>
        </div>
    </div>

    <!-- DASHBOARD SCREEN -->
    <div id="dashboard-screen" class="screen">
        <!-- SIDEBAR -->
        <aside class="sidebar" id="sidebar">
            <div class="brand">
                <i class="fas fa-layer-group"></i>
                <span>Lanting Digital</span>
            </div>

            <nav class="nav-links">
                <button class="nav-tab active" data-section="leads">
                    <i class="fas fa-envelope-open-text"></i>
                    Leads & Inquiries
                </button>
                <button class="nav-tab" data-section="contracts">
                    <i class="fas fa-file-signature"></i>
                    Contracts & Proposals
                </button>
                <button class="nav-tab" data-section="clients">
                    <i class="fas fa-users"></i>
                    Clients
                </button>
                <button class="nav-tab" data-section="messages">
                    <i class="fas fa-comments"></i>
                    Messages
                </button>
                <button class="nav-tab" data-section="invoices">
                    <i class="fas fa-file-invoice-dollar"></i>
                    Invoices
                </button>
                <button class="nav-tab" data-section="subscriptions">
                    <i class="fas fa-sync-alt"></i>
                    Subscriptions
                    <span class="nav-badge" id="unread-messages-badge" style="display: none;"></span>
                </button>
            </nav>

            <div class="user-profile">
                <div class="user-info-mini">
                    <span class="user-name" id="sidebar-user-name">Admin</span>
                    <span class="user-role">Administrator</span>
                </div>
                <button class="logout-icon" id="logout-btn" title="Logout">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>
            <div class="legal-links">
                <a href="https://lantingdigital.com/privacy.html" target="_blank">Privacy</a>
                <span class="separator">Â·</span>
                <a href="https://lantingdigital.com/terms.html" target="_blank">Terms</a>
            </div>
        </aside>

        <!-- MAIN CONTENT -->
        <main class="main-content">
            <!-- Top Bar -->
            <div class="top-bar">
                <div class="top-bar-left">
                    <button class="mobile-menu-btn" id="mobile-menu-btn">
                        <i class="fas fa-bars"></i>
                    </button>
                    <div class="page-title">
                        <h1 id="page-header-title">Leads & Inquiries</h1>
                        <p id="page-header-date"></p>
                    </div>
                </div>

                <div class="action-bar">
                    <!-- Admin Status Toggle -->
                    <div class="status-toggle-wrapper" id="status-toggle-wrapper">
                        <button class="status-toggle" id="status-toggle" title="Click to change status">
                            <span class="status-dot"></span>
                            <span class="status-text" id="status-text">Available</span>
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="status-dropdown" id="status-dropdown">
                            <button class="status-option" data-status="available">
                                <span class="status-dot available"></span>
                                <div class="status-option-info">
                                    <span class="status-option-label">Available</span>
                                    <span class="status-option-desc">~5 min response time</span>
                                </div>
                            </button>
                            <button class="status-option" data-status="busy">
                                <span class="status-dot busy"></span>
                                <div class="status-option-info">
                                    <span class="status-option-label">Busy</span>
                                    <span class="status-option-desc">30-60 min response time</span>
                                </div>
                            </button>
                            <button class="status-option" data-status="away">
                                <span class="status-dot away"></span>
                                <div class="status-option-info">
                                    <span class="status-option-label">Away</span>
                                    <span class="status-option-desc">1-2 business days</span>
                                </div>
                            </button>
                        </div>
                    </div>

                    <div class="search-wrapper">
                        <i class="fas fa-search"></i>
                        <input type="text" class="search-input" id="search-input" placeholder="Search records...">
                    </div>
                    <button class="btn btn-secondary" id="refresh-btn">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                </div>
            </div>

            <!-- LEADS SECTION -->
            <div id="leads-section" class="section-content active">
                <!-- Stats -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-inbox"></i></div>
                        <div class="stat-info">
                            <span class="stat-value" id="total-submissions">0</span>
                            <span class="stat-label">Active Leads</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-bolt"></i></div>
                        <div class="stat-info">
                            <span class="stat-value" id="today-submissions">0</span>
                            <span class="stat-label">New Today</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon muted"><i class="fas fa-archive"></i></div>
                        <div class="stat-info">
                            <span class="stat-value muted" id="archived-count">0</span>
                            <span class="stat-label">Archived</span>
                        </div>
                    </div>
                </div>

                <!-- Table Panel -->
                <div class="content-panel">
                    <div class="panel-header">
                        <h3>Recent Submissions</h3>
                        <div class="filter-group">
                            <button class="filter-btn active" id="view-active">All</button>
                            <button class="filter-btn" id="filter-active">Active</button>
                            <button class="filter-btn" id="view-archived">Archived</button>
                        </div>
                    </div>
                    <div class="table-responsive">
                        <table id="submissions-table">
                            <thead>
                                <tr>
                                    <th>Client Name</th>
                                    <th>Subject/Message</th>
                                    <th>Date Received</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="submissions-body">
                                <!-- Data loaded by JS -->
                            </tbody>
                        </table>
                    </div>
                    <div id="loading-state" class="loading-state">
                        <i class="fas fa-spinner fa-spin"></i>
                        <p>Loading submissions...</p>
                    </div>
                    <div id="empty-state" class="empty-state hidden">
                        <i class="fas fa-inbox"></i>
                        <p>No submissions found</p>
                    </div>
                </div>
            </div>

            <!-- CONTRACTS SECTION -->
            <div id="contracts-section" class="section-content">
                <!-- Stats -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-file-contract"></i></div>
                        <div class="stat-info">
                            <span class="stat-value" id="total-contracts">0</span>
                            <span class="stat-label">Total Contracts</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon warning"><i class="fas fa-hourglass-half"></i></div>
                        <div class="stat-info">
                            <span class="stat-value warning" id="sent-contracts">0</span>
                            <span class="stat-label">Pending Sign</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon success"><i class="fas fa-check-double"></i></div>
                        <div class="stat-info">
                            <span class="stat-value success" id="signed-contracts">0</span>
                            <span class="stat-label">Completed</span>
                        </div>
                    </div>
                </div>

                <!-- Table Panel -->
                <div class="content-panel">
                    <div class="panel-header">
                        <h3>Contract Management</h3>
                        <div class="panel-header-actions">
                            <button class="btn btn-primary btn-sm" id="create-contract-btn">
                                <i class="fas fa-plus"></i> Create Contract
                            </button>
                            <div class="filter-group">
                                <button class="filter-btn active" id="view-all-contracts">All</button>
                                <button class="filter-btn" id="view-pending-contracts">Pending</button>
                                <button class="filter-btn" id="view-signed-contracts">Signed</button>
                            </div>
                        </div>
                    </div>
                    <div class="table-responsive">
                        <table id="contracts-table">
                            <thead>
                                <tr>
                                    <th>Client Entity</th>
                                    <th>Project Scope</th>
                                    <th>Status</th>
                                    <th>Timeline</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="contracts-body">
                                <!-- Data loaded by JS -->
                            </tbody>
                        </table>
                    </div>
                    <div id="contracts-loading-state" class="loading-state">
                        <i class="fas fa-spinner fa-spin"></i>
                        <p>Loading contracts...</p>
                    </div>
                    <div id="contracts-empty-state" class="empty-state hidden">
                        <i class="fas fa-file-signature"></i>
                        <p>No contracts found</p>
                    </div>
                </div>
            </div>

            <!-- CLIENTS SECTION -->
            <div id="clients-section" class="section-content">
                <!-- Stats -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-users"></i></div>
                        <div class="stat-info">
                            <span class="stat-value" id="total-clients">0</span>
                            <span class="stat-label">Total Clients</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon success"><i class="fas fa-user-check"></i></div>
                        <div class="stat-info">
                            <span class="stat-value success" id="active-clients">0</span>
                            <span class="stat-label">Active Projects</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-file-invoice-dollar"></i></div>
                        <div class="stat-info">
                            <span class="stat-value" id="clients-pending-invoices">0</span>
                            <span class="stat-label">Pending Invoices</span>
                        </div>
                    </div>
                </div>

                <!-- Table Panel -->
                <div class="content-panel">
                    <div class="panel-header">
                        <h3>Client Directory</h3>
                        <div class="panel-header-actions">
                            <button class="btn btn-secondary btn-sm" id="invite-new-client-btn">
                                <i class="fas fa-envelope"></i> Invite to Portal
                            </button>
                            <button class="btn btn-primary btn-sm" id="add-client-btn">
                                <i class="fas fa-plus"></i> Add Client
                            </button>
                        </div>
                    </div>
                    <div class="table-responsive">
                        <table id="clients-table">
                            <thead>
                                <tr>
                                    <th>Client</th>
                                    <th>Company</th>
                                    <th>Email</th>
                                    <th>Portal</th>
                                    <th>Contracts</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="clients-body">
                                <!-- Data loaded by JS -->
                            </tbody>
                        </table>
                    </div>
                    <div id="clients-loading-state" class="loading-state">
                        <i class="fas fa-spinner fa-spin"></i>
                        <p>Loading clients...</p>
                    </div>
                    <div id="clients-empty-state" class="empty-state hidden">
                        <i class="fas fa-users"></i>
                        <p>No clients found</p>
                    </div>
                </div>
            </div>

            <!-- MESSAGES SECTION -->
            <div id="messages-section" class="section-content">
                <div class="messages-layout">
                    <!-- Conversations List -->
                    <div class="conversations-panel">
                        <div class="conversations-header">
                            <h3>Conversations</h3>
                        </div>
                        <div class="conversations-list" id="conversations-list">
                            <div class="loading-state">
                                <i class="fas fa-spinner fa-spin"></i>
                                <p>Loading...</p>
                            </div>
                        </div>
                    </div>

                    <!-- Chat Panel -->
                    <div class="chat-panel" id="chat-panel">
                        <div class="chat-empty-state" id="chat-empty">
                            <i class="fas fa-comments"></i>
                            <h3>Select a Conversation</h3>
                            <p>Choose a client from the list to view and send messages.</p>
                        </div>
                        <div class="chat-container hidden" id="chat-container">
                            <div class="chat-header">
                                <div class="chat-recipient">
                                    <div class="recipient-avatar" id="chat-recipient-avatar">--</div>
                                    <div class="recipient-info">
                                        <h4 id="chat-recipient-name">Client Name</h4>
                                        <p id="chat-recipient-email">client@email.com</p>
                                    </div>
                                </div>
                            </div>
                            <div class="chat-messages" id="chat-messages">
                                <!-- Messages loaded by JS -->
                            </div>
                            <div class="chat-input">
                                <input type="text" id="admin-message-input" placeholder="Type your message..." autocomplete="off">
                                <button class="btn btn-primary" id="send-admin-message">
                                    <i class="fas fa-paper-plane"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- INVOICES SECTION -->
            <div id="invoices-section" class="section-content">
                <div class="section-header">
                    <div class="section-title">
                        <h2>Invoices</h2>
                        <p>Create and manage client invoices</p>
                    </div>
                    <div class="section-header-actions">
                        <button class="btn btn-secondary" id="create-payment-plan-from-invoice-btn">
                            <i class="fas fa-calendar-alt"></i> Payment Plan
                        </button>
                        <button class="btn btn-primary" id="create-invoice-btn">
                            <i class="fas fa-plus"></i> Create Invoice
                        </button>
                    </div>
                </div>

                <!-- Invoice Stats -->
                <div class="invoice-stats">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-file-invoice-dollar"></i>
                        </div>
                        <div class="stat-info">
                            <span class="stat-value" id="total-invoices">0</span>
                            <span class="stat-label">Total Invoices</span>
                        </div>
                    </div>
                    <div class="stat-card pending">
                        <div class="stat-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="stat-info">
                            <span class="stat-value" id="pending-invoices">0</span>
                            <span class="stat-label">Pending</span>
                        </div>
                    </div>
                    <div class="stat-card paid">
                        <div class="stat-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="stat-info">
                            <span class="stat-value" id="paid-invoices">0</span>
                            <span class="stat-label">Paid</span>
                        </div>
                    </div>
                    <div class="stat-card revenue">
                        <div class="stat-icon">
                            <i class="fas fa-dollar-sign"></i>
                        </div>
                        <div class="stat-info">
                            <span class="stat-value" id="total-revenue">$0</span>
                            <span class="stat-label">Total Revenue</span>
                        </div>
                    </div>
                </div>

                <!-- Invoices Table -->
                <div class="card">
                    <div class="card-header">
                        <div class="invoice-filters">
                            <button class="filter-btn active" data-filter="all">All</button>
                            <button class="filter-btn" data-filter="draft">Draft</button>
                            <button class="filter-btn" data-filter="pending">Pending</button>
                            <button class="filter-btn" data-filter="paid">Paid</button>
                        </div>
                    </div>
                    <div class="card-body">
                        <table class="data-table" id="invoices-table">
                            <thead>
                                <tr>
                                    <th>Invoice #</th>
                                    <th>Client</th>
                                    <th>Amount</th>
                                    <th>Status</th>
                                    <th>Date</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="invoices-body">
                                <tr class="empty-row">
                                    <td colspan="6">
                                        <div class="empty-state">
                                            <i class="fas fa-file-invoice"></i>
                                            <p>No invoices yet</p>
                                            <button class="btn btn-primary btn-sm" onclick="openCreateInvoiceModal()">Create Your First Invoice</button>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- SUBSCRIPTIONS SECTION -->
            <div id="subscriptions-section" class="section-content">
                <div class="section-header">
                    <div class="section-title">
                        <h2>Subscriptions & Payment Plans</h2>
                        <p>Manage recurring billing and installment payments</p>
                    </div>
                    <div class="section-header-actions">
                        <button class="btn btn-secondary" id="create-payment-plan-btn">
                            <i class="fas fa-calendar-alt"></i> New Payment Plan
                        </button>
                        <button class="btn btn-primary" id="create-subscription-btn">
                            <i class="fas fa-sync-alt"></i> New Subscription
                        </button>
                    </div>
                </div>

                <!-- Subscription Stats -->
                <div class="subscription-stats">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-sync-alt"></i>
                        </div>
                        <div class="stat-info">
                            <span class="stat-value" id="active-subscriptions">0</span>
                            <span class="stat-label">Active Subscriptions</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-calendar-check"></i>
                        </div>
                        <div class="stat-info">
                            <span class="stat-value" id="active-payment-plans">0</span>
                            <span class="stat-label">Active Payment Plans</span>
                        </div>
                    </div>
                    <div class="stat-card revenue">
                        <div class="stat-icon">
                            <i class="fas fa-dollar-sign"></i>
                        </div>
                        <div class="stat-info">
                            <span class="stat-value" id="monthly-recurring">$0</span>
                            <span class="stat-label">Monthly Recurring</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon warning">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <div class="stat-info">
                            <span class="stat-value" id="failed-payments">0</span>
                            <span class="stat-label">Failed Payments</span>
                        </div>
                    </div>
                </div>

                <!-- Subscriptions Tabs -->
                <div class="card">
                    <div class="card-header">
                        <div class="subscription-filters">
                            <button class="filter-btn active" data-sub-filter="all">All</button>
                            <button class="filter-btn" data-sub-filter="subscriptions">Subscriptions</button>
                            <button class="filter-btn" data-sub-filter="payment_plans">Payment Plans</button>
                            <button class="filter-btn" data-sub-filter="failed">Failed</button>
                        </div>
                    </div>
                    <div class="card-body">
                        <table class="data-table" id="subscriptions-table">
                            <thead>
                                <tr>
                                    <th>Client</th>
                                    <th>Type</th>
                                    <th>Plan / Project</th>
                                    <th>Amount</th>
                                    <th>Progress</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="subscriptions-body">
                                <tr class="empty-row">
                                    <td colspan="7">
                                        <div class="empty-state">
                                            <i class="fas fa-sync-alt"></i>
                                            <p>No subscriptions yet</p>
                                            <button class="btn btn-primary btn-sm" onclick="openCreateSubscriptionModal()">Create First Subscription</button>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- LEAD DETAIL MODAL -->
    <div id="detail-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Lead Details</h2>
                <button class="modal-close"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <div class="detail-grid">
                    <div>
                        <span class="detail-label">Client Name</span>
                        <div class="detail-value highlight" id="modal-name"></div>
                    </div>
                    <div>
                        <span class="detail-label">Email Address</span>
                        <div class="detail-value" id="modal-email"></div>
                    </div>
                </div>
                <div class="detail-group">
                    <span class="detail-label">Submission Date</span>
                    <div class="detail-value" id="modal-date"></div>
                </div>
                <div class="detail-group">
                    <span class="detail-label">Project Inquiry</span>
                    <div class="message-box" id="modal-message"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="modal-archive">
                    <i class="fas fa-archive"></i> Archive
                </button>
                <button class="btn btn-danger" id="modal-delete">
                    <i class="fas fa-trash"></i> Delete
                </button>
                <a id="modal-email-link" class="btn btn-primary" href="#">
                    <i class="fas fa-envelope"></i> Reply via Email
                </a>
            </div>
        </div>
    </div>

    <!-- DELETE CONFIRMATION MODAL -->
    <div id="confirm-modal" class="modal">
        <div class="modal-content modal-sm">
            <div class="modal-header">
                <h2>Confirm Delete</h2>
                <button class="modal-close"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to permanently delete this submission? This action cannot be undone.</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary modal-cancel">Cancel</button>
                <button id="confirm-delete" class="btn btn-danger">Delete Forever</button>
            </div>
        </div>
    </div>

    <!-- CONTRACT DETAIL MODAL -->
    <div id="contract-modal" class="modal">
        <div class="modal-content modal-lg">
            <div class="modal-header">
                <h2>Contract Details</h2>
                <button class="modal-close"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <div class="detail-grid">
                    <div>
                        <span class="detail-label">Contract Name</span>
                        <div class="detail-value highlight" id="contract-modal-name"></div>
                        <br>
                        <span class="detail-label">Client Entity</span>
                        <div class="detail-value" id="contract-client-company"></div>
                    </div>
                    <div>
                        <span class="detail-label">Current Status</span>
                        <div id="contract-status"></div>
                        <br>
                        <span class="detail-label">Timeline</span>
                        <div class="detail-value">
                            <span id="contract-effective-date"></span>
                            <br><span class="text-muted" id="contract-sent-date"></span>
                            <br><span class="text-muted" id="contract-signed-date"></span>
                        </div>
                    </div>
                </div>

                <div class="detail-group" id="contract-client-info">
                    <span class="detail-label">Client Signature Info</span>
                    <div class="detail-value">
                        <strong id="contract-client-name"></strong> (<span id="contract-client-title"></span>)
                    </div>
                    <div class="detail-value text-muted" id="contract-client-email"></div>
                    <div class="detail-value">
                        <span class="detail-label">Portfolio Permission:</span> <span id="contract-portfolio"></span>
                    </div>
                </div>

                <!-- Signing Link (for pending contracts) -->
                <div id="signing-link-section" class="signing-link-section hidden">
                    <h4>Signing Link</h4>
                    <div class="signing-link-box">
                        <input type="text" id="signing-link-input" readonly>
                        <button class="btn btn-secondary btn-sm" id="copy-link-btn">
                            <i class="fas fa-copy"></i> Copy
                        </button>
                    </div>
                </div>

                <!-- Contract Content Preview -->
                <div id="contract-content-section" class="contract-content-section">
                    <div class="contract-content-header">
                        <h4>Contract Content</h4>
                        <button class="btn btn-sm btn-secondary" id="toggle-contract-content">
                            <i class="fas fa-chevron-down"></i> Show
                        </button>
                    </div>
                    <div id="contract-content-preview" class="contract-content-preview hidden">
                        <!-- Contract HTML will be injected here -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-danger" id="contract-delete-btn">
                    <i class="fas fa-trash"></i> Delete
                </button>
                <button class="btn btn-primary" id="view-contract-btn">
                    <i class="fas fa-external-link-alt"></i> View Full Contract
                </button>
            </div>
        </div>
    </div>

    <!-- CREATE CONTRACT MODAL -->
    <div id="create-contract-modal" class="modal">
        <div class="modal-content modal-lg">
            <div class="modal-header">
                <h2>Create New Contract</h2>
                <button class="modal-close"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <form id="create-contract-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="contract-name-input">Contract Name <span class="required">*</span></label>
                            <input type="text" id="contract-name-input" placeholder="e.g., Website Development Agreement" required>
                        </div>
                        <div class="form-group">
                            <label for="contract-subtitle-input">Subtitle</label>
                            <input type="text" id="contract-subtitle-input" placeholder="e.g., Service Agreement">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="client-email-input">Client Email <span class="required">*</span></label>
                            <input type="email" id="client-email-input" placeholder="client@company.com" required>
                        </div>
                        <div class="form-group">
                            <label for="client-company-input">Client Company</label>
                            <input type="text" id="client-company-input" placeholder="Company Name">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="contract-html-input">Contract HTML Content <span class="required">*</span></label>
                        <textarea id="contract-html-input" rows="12" placeholder="Paste your contract HTML content here..." required></textarea>
                        <span class="form-hint">Paste the HTML content of your contract. The signature section will be added automatically.</span>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="provider-name-input">Provider Name</label>
                            <input type="text" id="provider-name-input" value="Caleb Lanting" placeholder="Your Name">
                        </div>
                        <div class="form-group">
                            <label for="provider-title-input">Provider Title</label>
                            <input type="text" id="provider-title-input" value="Owner / Member" placeholder="Your Title">
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary modal-cancel">Cancel</button>
                <button class="btn btn-primary" id="save-contract-btn">
                    <i class="fas fa-save"></i> Create Contract
                </button>
            </div>
        </div>
    </div>

    <!-- ADD/EDIT CLIENT MODAL -->
    <div id="client-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="client-modal-title">Add Client</h2>
                <button class="modal-close"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <form id="client-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="client-name">Client Name <span class="required">*</span></label>
                            <input type="text" id="client-name" placeholder="Full Name" required>
                        </div>
                        <div class="form-group">
                            <label for="client-email">Email <span class="required">*</span></label>
                            <input type="email" id="client-email" placeholder="email@company.com" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="client-company">Company</label>
                            <input type="text" id="client-company" placeholder="Company Name">
                        </div>
                        <div class="form-group">
                            <label for="client-phone">Phone</label>
                            <input type="tel" id="client-phone" placeholder="(555) 123-4567">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="client-notes">Notes</label>
                        <textarea id="client-notes" rows="3" placeholder="Any additional notes about this client..."></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary modal-cancel">Cancel</button>
                <button class="btn btn-primary" id="save-client-btn">
                    <i class="fas fa-save"></i> Save Client
                </button>
            </div>
        </div>
    </div>

    <!-- CLIENT DETAIL MODAL -->
    <div id="client-detail-modal" class="modal">
        <div class="modal-content modal-lg">
            <div class="modal-header">
                <h2>Client Details</h2>
                <button class="modal-close"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <div class="detail-grid">
                    <div>
                        <span class="detail-label">Client Name</span>
                        <div class="detail-value highlight" id="client-detail-name"></div>
                    </div>
                    <div>
                        <span class="detail-label">Company</span>
                        <div class="detail-value" id="client-detail-company"></div>
                    </div>
                </div>
                <div class="detail-grid">
                    <div>
                        <span class="detail-label">Email</span>
                        <div class="detail-value" id="client-detail-email"></div>
                    </div>
                    <div>
                        <span class="detail-label">Phone</span>
                        <div class="detail-value" id="client-detail-phone"></div>
                    </div>
                </div>
                <div class="detail-grid">
                    <div>
                        <span class="detail-label">Portal Status</span>
                        <div class="detail-value" id="client-detail-portal-status"></div>
                    </div>
                    <div>
                        <span class="detail-label">Portal Activated</span>
                        <div class="detail-value" id="client-detail-portal-date"></div>
                    </div>
                </div>
                <div class="detail-group">
                    <span class="detail-label">Notes</span>
                    <div class="message-box" id="client-detail-notes"></div>
                </div>

                <!-- Client Contracts -->
                <div class="detail-group">
                    <span class="detail-label">Contracts</span>
                    <div id="client-contracts-list" class="client-contracts-list">
                        <!-- Loaded by JS -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="edit-client-btn">
                    <i class="fas fa-edit"></i> Edit
                </button>
                <button class="btn btn-danger" id="delete-client-btn">
                    <i class="fas fa-trash"></i> Delete
                </button>
                <button class="btn btn-secondary" id="invite-client-btn" style="display: none;">
                    <i class="fas fa-envelope"></i> Send Invite
                </button>
                <button class="btn btn-secondary" id="reset-password-btn" style="display: none;">
                    <i class="fas fa-key"></i> Reset Password
                </button>
                <button class="btn btn-primary" id="message-client-btn">
                    <i class="fas fa-comment"></i> Message
                </button>
            </div>
        </div>
    </div>

    <!-- INVITE CLIENT MODAL -->
    <div id="invite-client-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Invite Client to Portal</h2>
                <button class="modal-close"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <form id="invite-client-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="invite-name">Client Name <span class="required">*</span></label>
                            <input type="text" id="invite-name" placeholder="Full Name" required>
                        </div>
                        <div class="form-group">
                            <label for="invite-email">Email <span class="required">*</span></label>
                            <input type="email" id="invite-email" placeholder="email@company.com" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="invite-company">Company (optional)</label>
                        <input type="text" id="invite-company" placeholder="Company Name">
                    </div>
                    <p class="form-hint" style="margin-top: 1rem;">
                        <i class="fas fa-info-circle"></i>
                        An email invitation will be sent to the client with a link to set up their portal account.
                        The link expires in 7 days.
                    </p>
                </form>
                <div id="invite-success" class="invite-success hidden">
                    <i class="fas fa-check-circle"></i>
                    <h3>Invitation Sent!</h3>
                    <p>An email has been sent to <strong id="invite-success-email"></strong></p>
                    <div class="invite-link-box">
                        <label>Or share this link directly:</label>
                        <div class="invite-link-input-wrapper">
                            <input type="text" id="invite-link" readonly>
                            <button class="btn btn-sm btn-secondary" id="copy-invite-link">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer" id="invite-modal-footer">
                <button class="btn btn-secondary modal-cancel">Cancel</button>
                <button class="btn btn-primary" id="send-invite-btn">
                    <i class="fas fa-paper-plane"></i> Send Invitation
                </button>
            </div>
            <div class="modal-footer hidden" id="invite-success-footer">
                <button class="btn btn-primary" id="invite-done-btn">Done</button>
            </div>
        </div>
    </div>

    <!-- CREATE INVOICE MODAL -->
    <div id="invoice-modal" class="modal">
        <div class="modal-content modal-lg">
            <div class="modal-header">
                <h2 id="invoice-modal-title">Create Invoice</h2>
                <button class="modal-close" onclick="closeInvoiceModal()"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <form id="invoice-form">
                    <!-- Client Selection -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="invoice-client">Client <span class="required">*</span></label>
                            <select id="invoice-client" required>
                                <option value="">Select a client...</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="invoice-due-date">Due Date</label>
                            <select id="invoice-due-date">
                                <option value="0">Due on Receipt</option>
                                <option value="7">Net 7 (7 days)</option>
                                <option value="15">Net 15 (15 days)</option>
                                <option value="30">Net 30 (30 days)</option>
                            </select>
                        </div>
                    </div>

                    <!-- Line Items -->
                    <div class="form-group">
                        <label>Line Items <span class="required">*</span></label>
                        <div class="line-items-container" id="line-items-container">
                            <div class="line-item" data-index="0">
                                <input type="text" class="line-description" placeholder="Description (e.g., Web Development)" required>
                                <input type="number" class="line-quantity" placeholder="Qty" value="1" min="1" required>
                                <input type="number" class="line-price" placeholder="Price" step="0.01" min="0" required>
                                <span class="line-total">$0.00</span>
                                <button type="button" class="btn-remove-line" onclick="removeLineItem(this)" title="Remove">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                        <button type="button" class="btn btn-secondary btn-sm" id="add-line-item">
                            <i class="fas fa-plus"></i> Add Line Item
                        </button>
                    </div>

                    <!-- Totals -->
                    <div class="invoice-totals">
                        <div class="total-row">
                            <span>Subtotal:</span>
                            <span id="invoice-subtotal">$0.00</span>
                        </div>
                        <div class="total-row grand-total">
                            <span>Total:</span>
                            <span id="invoice-total">$0.00</span>
                        </div>
                    </div>

                    <!-- Notes -->
                    <div class="form-group">
                        <label for="invoice-notes">Notes / Terms (optional)</label>
                        <textarea id="invoice-notes" rows="3" placeholder="Payment terms, late fees, or other notes..."></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline" onclick="closeInvoiceModal()">Cancel</button>
                <button type="button" class="btn btn-secondary" id="save-draft-btn" onclick="saveInvoiceDraft()">
                    <i class="fas fa-save"></i> Save as Draft
                </button>
                <button type="button" class="btn btn-primary" id="send-invoice-btn" onclick="sendInvoice()">
                    <i class="fas fa-paper-plane"></i> Send Invoice
                </button>
            </div>
        </div>
    </div>

    <!-- VIEW INVOICE MODAL -->
    <div id="view-invoice-modal" class="modal">
        <div class="modal-content modal-lg">
            <div class="modal-header">
                <h2>Invoice <span id="view-invoice-number"></span></h2>
                <button class="modal-close" onclick="closeViewInvoiceModal()"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <div id="view-invoice-content">
                    <!-- Invoice details loaded by JS -->
                </div>
            </div>
            <div class="modal-footer" id="view-invoice-actions">
                <!-- Actions loaded by JS based on status -->
            </div>
        </div>
    </div>

    <!-- CREATE SUBSCRIPTION MODAL -->
    <div id="subscription-modal" class="modal">
        <div class="modal-content modal-lg">
            <div class="modal-header">
                <h2>Create Subscription</h2>
                <button class="modal-close" onclick="closeSubscriptionModal()"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <form id="subscription-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="sub-client">Client <span class="required">*</span></label>
                            <select id="sub-client" required>
                                <option value="">Select a client...</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="sub-plan-type">Plan Type <span class="required">*</span></label>
                            <select id="sub-plan-type" required>
                                <option value="">Select plan type...</option>
                                <option value="retainer">Maintenance Retainer</option>
                                <option value="saas">SaaS Hosting</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="sub-plan-tier">Plan Tier <span class="required">*</span></label>
                        <select id="sub-plan-tier" required disabled>
                            <option value="">Select plan type first...</option>
                        </select>
                    </div>
                    <div class="subscription-preview hidden" id="sub-preview">
                        <div class="preview-card">
                            <div class="preview-header">
                                <span class="preview-label">Subscription Preview</span>
                            </div>
                            <div class="preview-body">
                                <div class="preview-row">
                                    <span>Monthly Amount:</span>
                                    <strong id="sub-preview-amount">$0.00</strong>
                                </div>
                                <div class="preview-row">
                                    <span>Billing:</span>
                                    <span>Recurring until cancelled</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline" onclick="closeSubscriptionModal()">Cancel</button>
                <button type="button" class="btn btn-primary" id="create-sub-btn" onclick="createSubscription()">
                    <i class="fas fa-sync-alt"></i> Create & Send Payment Link
                </button>
            </div>
        </div>
    </div>

    <!-- CREATE PAYMENT PLAN MODAL -->
    <div id="payment-plan-modal" class="modal">
        <div class="modal-content modal-lg">
            <div class="modal-header">
                <h2>Create Payment Plan</h2>
                <button class="modal-close" onclick="closePaymentPlanModal()"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <form id="payment-plan-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="pp-client">Client <span class="required">*</span></label>
                            <select id="pp-client" required>
                                <option value="">Select a client...</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="pp-project-name">Project Name <span class="required">*</span></label>
                            <input type="text" id="pp-project-name" placeholder="e.g., Website Redesign" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="pp-total-amount">Total Project Amount <span class="required">*</span></label>
                            <div class="input-with-prefix">
                                <span class="input-prefix">$</span>
                                <input type="number" id="pp-total-amount" placeholder="5000" step="0.01" min="1" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="pp-num-payments">Number of Payments <span class="required">*</span></label>
                            <select id="pp-num-payments" required>
                                <option value="2">2 payments</option>
                                <option value="3" selected>3 payments</option>
                                <option value="4">4 payments</option>
                                <option value="5">5 payments</option>
                                <option value="6">6 payments</option>
                                <option value="12">12 payments</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="pp-start-date">First Payment Date</label>
                            <input type="date" id="pp-start-date" class="form-input">
                            <span class="form-hint">Leave blank to charge immediately when client pays</span>
                        </div>
                        <div class="form-group">
                            <label for="pp-description">Description (optional)</label>
                            <textarea id="pp-description" rows="2" placeholder="Brief description of what this payment plan covers..."></textarea>
                        </div>
                    </div>
                    <div class="payment-plan-preview" id="pp-preview">
                        <div class="preview-card">
                            <div class="preview-header">
                                <span class="preview-label">Payment Plan Preview</span>
                            </div>
                            <div class="preview-body">
                                <div class="preview-row">
                                    <span>Monthly Payment:</span>
                                    <strong id="pp-preview-monthly">$0.00</strong>
                                </div>
                                <div class="preview-row">
                                    <span>Total Amount:</span>
                                    <span id="pp-preview-total">$0.00</span>
                                </div>
                                <div class="preview-row">
                                    <span>Duration:</span>
                                    <span id="pp-preview-duration">0 months</span>
                                </div>
                                <div class="preview-row">
                                    <span>First Charge:</span>
                                    <span id="pp-preview-start">Immediately</span>
                                </div>
                            </div>
                            <div class="preview-note">
                                <i class="fas fa-info-circle"></i>
                                Client will be auto-charged monthly. Plan ends automatically after final payment.
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline" onclick="closePaymentPlanModal()">Cancel</button>
                <button type="button" class="btn btn-primary" id="create-pp-btn" onclick="createPaymentPlan()">
                    <i class="fas fa-calendar-alt"></i> Create & Send Payment Link
                </button>
            </div>
        </div>
    </div>

    <!-- VIEW SUBSCRIPTION MODAL -->
    <div id="view-subscription-modal" class="modal">
        <div class="modal-content modal-lg">
            <div class="modal-header">
                <h2>Subscription Details</h2>
                <button class="modal-close" onclick="closeViewSubscriptionModal()"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body" id="view-subscription-content">
                <!-- Subscription details loaded by JS -->
            </div>
            <div class="modal-footer" id="view-subscription-actions">
                <!-- Actions loaded by JS based on status -->
            </div>
        </div>
    </div>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.6.7/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.7/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.7/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.7/firebase-functions-compat.js"></script>

    <!-- Admin Scripts -->
    <script src="js/config.js?v=20260103f"></script>
    <script src="js/auth.js?v=20260103f"></script>
    <script src="js/dashboard.js?v=20260103f"></script>
    <script src="js/contracts.js?v=20260103f"></script>
    <script src="js/clients.js?v=20260103f"></script>
    <script src="js/messages.js?v=20260103f"></script>
    <script src="js/invoices.js?v=20260103f"></script>
    <script src="js/subscriptions.js?v=20260103f"></script>
</body>
</html>
